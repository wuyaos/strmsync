# STRMSync é…ç½®ç®¡ç†æ–¹æ¡ˆ

## é…ç½®ç®¡ç†ç­–ç•¥

### é…ç½®åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¯åŠ¨é…ç½®æ–‡ä»¶                              â”‚
â”‚               (config.yaml - æœ€å°åŒ–)                         â”‚
â”‚  - æœåŠ¡å™¨ç«¯å£                                                â”‚
â”‚  - æ•°æ®åº“è·¯å¾„                                                â”‚
â”‚  - æ—¥å¿—è·¯å¾„                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åº“é…ç½®ï¼ˆsettings è¡¨ï¼‰                  â”‚
â”‚               âœ… é€šè¿‡ Web ç•Œé¢ç®¡ç†                           â”‚
â”‚  - æ•°æ®æºé…ç½®ï¼ˆæœ¬åœ°/CloudDrive2/OpenListï¼‰                   â”‚
â”‚  - åª’ä½“åº“é€šçŸ¥é…ç½®ï¼ˆEmby/Jellyfinï¼‰                          â”‚
â”‚  - æ‰«æé€‰é¡¹                                                  â”‚
â”‚  - STRM é€‰é¡¹                                                 â”‚
â”‚  - ç›‘æ§é€‰é¡¹                                                  â”‚
â”‚  - å®šæ—¶ä»»åŠ¡é…ç½®                                              â”‚
â”‚  - æ’é™¤è§„åˆ™                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. æœ€å°åŒ–å¯åŠ¨é…ç½®æ–‡ä»¶

### config.yamlï¼ˆä»…åŒ…å«å¯åŠ¨å¿…éœ€å‚æ•°ï¼‰

```yaml
# æœåŠ¡å™¨é…ç½®
server:
  port: 3000
  host: 0.0.0.0

# æ•°æ®åº“é…ç½®
database:
  path: /app/data/strmsync.db

# æ—¥å¿—é…ç½®
log:
  path: /app/logs/strmsync.log
  level: info

# æ—¶åŒº
timezone: Asia/Shanghai
```

**è¯´æ˜**ï¼š
- âœ… è¿™ä¸ªæ–‡ä»¶åªåœ¨å®¹å™¨å¯åŠ¨æ—¶è¯»å–ä¸€æ¬¡
- âœ… ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é…ç½®
- âœ… ç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç¼–è¾‘ï¼ˆä½¿ç”¨é»˜è®¤å€¼å³å¯ï¼‰

---

## 2. æ•°æ®åº“é…ç½®ç®¡ç†

### 2.1 Settings è¡¨ç»“æ„

```sql
CREATE TABLE settings (
    key VARCHAR(255) PRIMARY KEY,
    value TEXT NOT NULL,
    category VARCHAR(50) NOT NULL,     -- general/scan/strm/notifiers/scheduler
    description TEXT,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 2.2 é…ç½®æ•°æ®ç»“æ„

#### é€šç”¨é…ç½®

```json
{
  "key": "general.system_name",
  "value": "STRMSync",
  "category": "general",
  "description": "ç³»ç»Ÿåç§°"
}

{
  "key": "general.timezone",
  "value": "Asia/Shanghai",
  "category": "general"
}

{
  "key": "general.log_level",
  "value": "info",
  "category": "general",
  "description": "æ—¥å¿—çº§åˆ«ï¼šdebug/info/warn/error"
}
```

---

#### æ‰«æé…ç½®

```json
{
  "key": "scan.concurrency",
  "value": "50",
  "category": "scan",
  "description": "å¹¶å‘ Goroutine æ•°"
}

{
  "key": "scan.batch_size",
  "value": "1000",
  "category": "scan",
  "description": "æ‰¹é‡å†™å…¥å¤§å°"
}

{
  "key": "scan.hash_sample_size",
  "value": "1048576",
  "category": "scan",
  "description": "å“ˆå¸Œæ ·æœ¬å¤§å°ï¼ˆå­—èŠ‚ï¼‰"
}

{
  "key": "scan.exclude_patterns",
  "value": ".tmp,.@__thumb,*.partial",
  "category": "scan",
  "description": "æ’é™¤è§„åˆ™ï¼ˆé€—å·åˆ†éš”ï¼‰"
}
```

---

#### STRM é…ç½®

```json
{
  "key": "strm.path_format",
  "value": "absolute",
  "category": "strm",
  "description": "è·¯å¾„æ ¼å¼ï¼šabsolute/relative"
}

{
  "key": "strm.encoding",
  "value": "utf-8",
  "category": "strm"
}

{
  "key": "strm.line_ending",
  "value": "lf",
  "category": "strm",
  "description": "æ¢è¡Œç¬¦ï¼šlf/crlf"
}
```

---

#### å®šæ—¶ä»»åŠ¡é…ç½®

```json
{
  "key": "scheduler.full_scan_cron",
  "value": "0 2 * * *",
  "category": "scheduler",
  "description": "å…¨é‡æ‰«æ Cron è¡¨è¾¾å¼ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰"
}

{
  "key": "scheduler.cleanup_cron",
  "value": "0 3 * * 0",
  "category": "scheduler",
  "description": "æ¸…ç†ä»»åŠ¡ Cron è¡¨è¾¾å¼ï¼ˆæ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹ï¼‰"
}
```

---

### 2.3 æ•°æ®æºé…ç½®ï¼ˆsources è¡¨ï¼‰

æ•°æ®æºé…ç½®ç›´æ¥å­˜å‚¨åœ¨ `sources` è¡¨ä¸­ï¼Œé€šè¿‡ Web ç•Œé¢çš„"æ•°æ®æºç®¡ç†"é¡µé¢è¿›è¡Œ CRUD æ“ä½œã€‚

**è¡¨ç»“æ„**ï¼ˆå·²åœ¨å®æ–½è®¡åˆ’ä¸­å®šä¹‰ï¼‰ï¼š
```sql
CREATE TABLE sources (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(255) NOT NULL UNIQUE,
    type VARCHAR(50) NOT NULL,          -- local/clouddrive2/openlist
    enabled BOOLEAN NOT NULL DEFAULT TRUE,
    config TEXT NOT NULL,               -- JSON é…ç½®
    source_prefix VARCHAR(500) NOT NULL,
    target_prefix VARCHAR(500) NOT NULL,
    options TEXT,                       -- JSON é«˜çº§é€‰é¡¹
    status VARCHAR(50) DEFAULT 'idle',
    last_scan_at DATETIME,
    file_count INTEGER DEFAULT 0,
    error_message TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

**config å­—æ®µç¤ºä¾‹ï¼ˆJSONï¼‰**ï¼š

```json
// CloudDrive2
{
  "api_url": "http://localhost:19798",
  "auth_mode": "password",
  "username": "admin",
  "password": "encrypted:xxx",
  "mount_path": "/mnt/clouddrive"
}

// OpenList HTTP æ¨¡å¼
{
  "api_url": "http://localhost:5244",
  "auth_mode": "password",
  "username": "admin",
  "password": "encrypted:xxx",
  "strm_mode": "http"
}

// OpenList æœ¬åœ°æ¨¡å¼
{
  "api_url": "http://localhost:5244",
  "auth_mode": "password",
  "username": "admin",
  "password": "encrypted:xxx",
  "strm_mode": "local",
  "mount_path": "/mnt/openlist"
}
```

---

### 2.4 é€šçŸ¥å™¨é…ç½®ï¼ˆnotifiers è¡¨ï¼‰

```sql
CREATE TABLE notifiers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    type VARCHAR(50) NOT NULL UNIQUE,   -- emby/jellyfin
    enabled BOOLEAN NOT NULL DEFAULT FALSE,
    config TEXT NOT NULL,               -- JSON é…ç½®
    status VARCHAR(50) DEFAULT 'idle',  -- idle/connected/error
    last_test_at DATETIME,
    error_message TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

**config å­—æ®µç¤ºä¾‹ï¼ˆJSONï¼‰**ï¼š

```json
// Emby
{
  "url": "http://localhost:8096",
  "auth_mode": "api_key",
  "api_key": "encrypted:xxx",
  "timeout": 10,
  "retry": 3
}

// Jellyfin
{
  "url": "http://localhost:8096",
  "auth_mode": "password",
  "username": "admin",
  "password": "encrypted:xxx",
  "timeout": 10,
  "retry": 3
}
```

---

## 3. Web ç•Œé¢é…ç½®ç®¡ç†

### 3.1 ç³»ç»Ÿè®¾ç½®é¡µé¢

#### 3.1.1 é€šç”¨è®¾ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿè®¾ç½®                                        [ä¿å­˜] [é‡ç½®] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  [é€šç”¨] [æ‰«æ] [STRM] [å®šæ—¶ä»»åŠ¡] [é«˜çº§]                        â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ é€šç”¨è®¾ç½®                                                  â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ ç³»ç»Ÿåç§°: [STRMSync_____________________________]         â”‚â”‚
â”‚  â”‚ æ—¶åŒº:     [Asia/Shanghai â–¼]                               â”‚â”‚
â”‚  â”‚ æ—¥å¿—çº§åˆ«: [INFO â–¼] (DEBUG/INFO/WARN/ERROR)                â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚                                         [å–æ¶ˆ] [æµ‹è¯•] [ä¿å­˜]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**API æ¥å£**ï¼š
```
GET  /api/settings?category=general
PUT  /api/settings/general
```

---

#### 3.1.2 æ‰«æè®¾ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰«æè®¾ç½®                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ å¹¶å‘æ•°:       [50__] Goroutines                           â”‚â”‚
â”‚  â”‚ æ‰¹é‡å¤§å°:     [1000__] æ¡/äº‹åŠ¡                            â”‚â”‚
â”‚  â”‚ å“ˆå¸Œæ ·æœ¬å¤§å°: [1__] MB                                    â”‚â”‚
â”‚  â”‚ è·³è¿‡éšè—æ–‡ä»¶: [âœ“]                                        â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æ’é™¤è§„åˆ™:                                                 â”‚â”‚
â”‚  â”‚ [.tmp, .@__thumb, *.partial_________________________]     â”‚â”‚
â”‚  â”‚ (é€—å·åˆ†éš”)                                                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.1.3 STRM è®¾ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STRM è®¾ç½®                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ è·¯å¾„æ ¼å¼:     (â—) ç»å¯¹è·¯å¾„  ( ) ç›¸å¯¹è·¯å¾„                 â”‚â”‚
â”‚  â”‚ ç¼–ç æ ¼å¼:     [UTF-8 â–¼]                                   â”‚â”‚
â”‚  â”‚ æ¢è¡Œç¬¦:       [LF â–¼] (LF/CRLF)                            â”‚â”‚
â”‚  â”‚ å¹‚ç­‰æ€§æ£€æŸ¥:   [âœ“] å¯ç”¨ï¼ˆé¿å…é‡å¤ç”Ÿæˆï¼‰                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.1.4 å®šæ—¶ä»»åŠ¡è®¾ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®šæ—¶ä»»åŠ¡                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ å…¨é‡æ‰«æ:     [âœ“] å¯ç”¨                                    â”‚â”‚
â”‚  â”‚ Cron è¡¨è¾¾å¼:  [0 2 * * *____________] (æ¯å¤©å‡Œæ™¨2ç‚¹)       â”‚â”‚
â”‚  â”‚               [Cron è¡¨è¾¾å¼å¸®åŠ© â–¼]                         â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æ¸…ç†ä»»åŠ¡:     [âœ“] å¯ç”¨                                    â”‚â”‚
â”‚  â”‚ Cron è¡¨è¾¾å¼:  [0 3 * * 0____________] (æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹)     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.2 æ•°æ®æºç®¡ç†é¡µé¢

#### æ·»åŠ æ•°æ®æºå¯¹è¯æ¡†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ æ•°æ®æº                                        [âœ• å…³é—­]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  æ­¥éª¤ 1: é€‰æ‹©æ•°æ®æºç±»å‹                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ğŸ“ æœ¬åœ°     â”‚ â”‚ â˜ï¸ CloudDrive2â”‚ â”‚ ğŸŒ OpenList â”‚            â”‚
â”‚  â”‚ [é€‰æ‹©]      â”‚ â”‚ [é€‰æ‹©]      â”‚ â”‚ [é€‰æ‹©]      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                â”‚
â”‚  æ­¥éª¤ 2: åŸºç¡€ä¿¡æ¯                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ æ•°æ®æºåç§°: [___________________________________]          â”‚â”‚
â”‚  â”‚ æºè·¯å¾„å‰ç¼€: [___________________________________]          â”‚â”‚
â”‚  â”‚ ç›®æ ‡è·¯å¾„:   [___________________________________]          â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ [âœ“] å¯ç”¨æ­¤æ•°æ®æº                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚  æ­¥éª¤ 3: è¿æ¥é…ç½®ï¼ˆCloudDrive2ï¼‰                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ API åœ°å€:   [http://localhost:19798___________]           â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ è®¤è¯æ–¹å¼:   (â—) ç”¨æˆ·åå¯†ç   ( ) API Token                â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ ç”¨æˆ·å:     [admin_____________________________]          â”‚â”‚
â”‚  â”‚ å¯†ç :       [***************************] [æ˜¾ç¤º]          â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æŒ‚è½½è·¯å¾„:   [/mnt/clouddrive___________________]          â”‚â”‚
â”‚  â”‚             (CloudDrive2 çš„æœ¬åœ°æŒ‚è½½ç›®å½•)                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚  æ­¥éª¤ 4: é«˜çº§é€‰é¡¹                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [âœ“] å¯ç”¨æ–‡ä»¶ç›‘æ§                                          â”‚â”‚
â”‚  â”‚ [âœ“] è‡ªåŠ¨åŒæ­¥å…ƒæ•°æ®                                        â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ å¥åº·æ£€æŸ¥é—´éš”: [60__] ç§’                                   â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æ’é™¤è§„åˆ™:                                                 â”‚â”‚
â”‚  â”‚ [.tmp, *.partial____________________] (é€—å·åˆ†éš”)          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚  æ­¥éª¤ 5: æµ‹è¯•è¿æ¥                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [æµ‹è¯•è¿æ¥]                                                â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ âœ“ API è¿æ¥æˆåŠŸ                                            â”‚â”‚
â”‚  â”‚ âœ“ è®¤è¯æˆåŠŸ                                                â”‚â”‚
â”‚  â”‚ âœ“ æŒ‚è½½è·¯å¾„å¯è®¿é—®                                          â”‚â”‚
â”‚  â”‚ âœ“ æºè·¯å¾„å­˜åœ¨ (å‘ç° 1,234 ä¸ªæ–‡ä»¶)                         â”‚â”‚
â”‚  â”‚ âœ“ ç›®æ ‡è·¯å¾„å¯å†™                                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚                                        [å–æ¶ˆ] [æµ‹è¯•] [ä¿å­˜]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### OpenList é…ç½®è¡¨å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿æ¥é…ç½®ï¼ˆOpenListï¼‰                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ API åœ°å€:   [http://localhost:5244____________]           â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ è®¤è¯æ–¹å¼:   (â—) ç”¨æˆ·åå¯†ç   ( ) Token                    â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ ç”¨æˆ·å:     [admin_____________________________]          â”‚â”‚
â”‚  â”‚ å¯†ç :       [***************************] [æ˜¾ç¤º]          â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ STRM æ¨¡å¼:  (â—) HTTP é“¾æ¥  ( ) æœ¬åœ°è·¯å¾„                  â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚  â”‚ â”‚ å¦‚æœé€‰æ‹©"æœ¬åœ°è·¯å¾„"ï¼Œéœ€è¦å…ˆé€šè¿‡ rclone æˆ– CloudDrive2 â”‚ â”‚â”‚
â”‚  â”‚ â”‚ å°† OpenList æŒ‚è½½åˆ°æœ¬åœ°ï¼Œç„¶åå¡«å†™æŒ‚è½½è·¯å¾„ï¼š           â”‚ â”‚â”‚
â”‚  â”‚ â”‚                                                       â”‚ â”‚â”‚
â”‚  â”‚ â”‚ æŒ‚è½½è·¯å¾„: [/mnt/openlist__________] (ä»…æœ¬åœ°æ¨¡å¼)     â”‚ â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ HTTP ä»£ç†:  [_________________________________] (å¯é€‰)    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚  STRM ç¤ºä¾‹:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ HTTP æ¨¡å¼:                                                â”‚â”‚
â”‚  â”‚   æºæ–‡ä»¶: /Movies/Action/Movie.mkv                        â”‚â”‚
â”‚  â”‚   STRM å†…å®¹: http://localhost:5244/d/Movies/Action/Movie.mkvâ”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æœ¬åœ°æ¨¡å¼:                                                 â”‚â”‚
â”‚  â”‚   æºæ–‡ä»¶: /Movies/Action/Movie.mkv                        â”‚â”‚
â”‚  â”‚   æŒ‚è½½è·¯å¾„: /mnt/openlist                                 â”‚â”‚
â”‚  â”‚   STRM å†…å®¹: /mnt/openlist/Movies/Action/Movie.mkv       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.3 é€šçŸ¥å™¨ç®¡ç†é¡µé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åª’ä½“åº“é€šçŸ¥è®¾ç½®                                [ä¿å­˜] [æµ‹è¯•]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Emby                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [âœ“] å¯ç”¨                                                  â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æœåŠ¡å™¨åœ°å€: [http://localhost:8096________________]       â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ è®¤è¯æ–¹å¼:   (â—) API Key  ( ) ç”¨æˆ·åå¯†ç                   â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ API Key:    [***************************] [æ˜¾ç¤º] [æµ‹è¯•]   â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ é«˜çº§é€‰é¡¹:                                                 â”‚â”‚
â”‚  â”‚   è¶…æ—¶æ—¶é—´: [10__] ç§’                                     â”‚â”‚
â”‚  â”‚   é‡è¯•æ¬¡æ•°: [3__] æ¬¡                                      â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ è¿æ¥çŠ¶æ€: âœ“ å·²è¿æ¥ (æœ€åæµ‹è¯•: 2åˆ†é’Ÿå‰)                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚  Jellyfin                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [ ] å¯ç”¨                                                  â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ æœåŠ¡å™¨åœ°å€: [http://localhost:8096________________]       â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ è®¤è¯æ–¹å¼:   ( ) API Key  ( ) ç”¨æˆ·åå¯†ç                   â”‚â”‚
â”‚  â”‚                                                           â”‚â”‚
â”‚  â”‚ API Key:    [___________________________] [æ˜¾ç¤º] [æµ‹è¯•]   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                â”‚
â”‚                                        [å–æ¶ˆ] [æµ‹è¯•] [ä¿å­˜]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. API æ¥å£è®¾è®¡

### 4.1 ç³»ç»Ÿè®¾ç½® API

#### GET /api/settings
è·å–æ‰€æœ‰è®¾ç½®

**æŸ¥è¯¢å‚æ•°**:
- `category`: ç­›é€‰ç±»åˆ«ï¼ˆgeneral/scan/strm/schedulerï¼‰

**å“åº”**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "general": {
      "system_name": "STRMSync",
      "timezone": "Asia/Shanghai",
      "log_level": "info"
    },
    "scan": {
      "concurrency": 50,
      "batch_size": 1000,
      "hash_sample_size": 1048576,
      "exclude_patterns": ".tmp,.@__thumb,*.partial"
    }
  }
}
```

---

#### PUT /api/settings/:category
æ›´æ–°è®¾ç½®

**è¯·æ±‚**:
```json
{
  "concurrency": 100,
  "batch_size": 2000
}
```

**å“åº”**:
```json
{
  "code": 200,
  "message": "Settings updated successfully"
}
```

---

### 4.2 æ•°æ®æº API

#### GET /api/sources
åˆ—å‡ºæ‰€æœ‰æ•°æ®æº

#### POST /api/sources
åˆ›å»ºæ•°æ®æº

**è¯·æ±‚**:
```json
{
  "name": "æœ¬åœ°ç”µå½±",
  "type": "local",
  "enabled": true,
  "source_prefix": "/volume1/Media/Movies",
  "target_prefix": "/media/library/Movies",
  "config": {},
  "options": {
    "enable_watch": true,
    "sync_metadata": true
  }
}
```

---

#### PUT /api/sources/:id
æ›´æ–°æ•°æ®æº

#### DELETE /api/sources/:id
åˆ é™¤æ•°æ®æº

#### POST /api/sources/:id/test
æµ‹è¯•è¿æ¥

**å“åº”**:
```json
{
  "code": 200,
  "message": "Connection test successful",
  "data": {
    "api_connected": true,
    "auth_success": true,
    "source_path_accessible": true,
    "source_file_count": 1234,
    "target_path_writable": true
  }
}
```

---

### 4.3 é€šçŸ¥å™¨ API

#### GET /api/notifiers
åˆ—å‡ºæ‰€æœ‰é€šçŸ¥å™¨

**å“åº”**:
```json
{
  "code": 200,
  "data": [
    {
      "id": 1,
      "type": "emby",
      "enabled": true,
      "status": "connected",
      "config": {
        "url": "http://localhost:8096",
        "auth_mode": "api_key"
      },
      "last_test_at": "2024-02-16T10:30:00Z"
    }
  ]
}
```

---

#### PUT /api/notifiers/:type
æ›´æ–°é€šçŸ¥å™¨é…ç½®

**è¯·æ±‚**:
```json
{
  "enabled": true,
  "config": {
    "url": "http://localhost:8096",
    "auth_mode": "api_key",
    "api_key": "your-api-key",
    "timeout": 10,
    "retry": 3
  }
}
```

---

#### POST /api/notifiers/:type/test
æµ‹è¯•é€šçŸ¥å™¨è¿æ¥

**å“åº”**:
```json
{
  "code": 200,
  "message": "Connection test successful",
  "data": {
    "connected": true,
    "server_version": "4.8.0.0",
    "response_time_ms": 45
  }
}
```

---

## 5. é…ç½®åŠ å¯†

### 5.1 æ•æ„Ÿä¿¡æ¯åŠ å¯†

æ‰€æœ‰å¯†ç ã€API Keyã€Token åœ¨å­˜å‚¨åˆ°æ•°æ®åº“å‰éœ€è¦åŠ å¯†ã€‚

**åŠ å¯†æ–¹æ¡ˆ**:
- ä½¿ç”¨ AES-256-GCM åŠ å¯†
- å¯†é’¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡æˆ–å¯åŠ¨é…ç½®ä¸­
- åŠ å¯†åçš„å€¼æ ¼å¼ï¼š`encrypted:base64string`

**Go å®ç°ç¤ºä¾‹**:
```go
func EncryptPassword(plaintext string, key []byte) (string, error) {
    block, err := aes.NewCipher(key)
    if err != nil {
        return "", err
    }

    gcm, err := cipher.NewGCM(block)
    if err != nil {
        return "", err
    }

    nonce := make([]byte, gcm.NonceSize())
    io.ReadFull(rand.Reader, nonce)

    ciphertext := gcm.Seal(nonce, nonce, []byte(plaintext), nil)
    return "encrypted:" + base64.StdEncoding.EncodeToString(ciphertext), nil
}

func DecryptPassword(encrypted string, key []byte) (string, error) {
    if !strings.HasPrefix(encrypted, "encrypted:") {
        return "", errors.New("invalid encrypted format")
    }

    ciphertext, _ := base64.StdEncoding.DecodeString(strings.TrimPrefix(encrypted, "encrypted:"))

    block, _ := aes.NewCipher(key)
    gcm, _ := cipher.NewGCM(block)

    nonceSize := gcm.NonceSize()
    nonce, ciphertext := ciphertext[:nonceSize], ciphertext[nonceSize:]

    plaintext, err := gcm.Open(nil, nonce, ciphertext, nil)
    return string(plaintext), err
}
```

---

## 6. é…ç½®åˆå§‹åŒ–

### 6.1 é¦–æ¬¡å¯åŠ¨

åº”ç”¨é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®ï¼š

```go
func InitDefaultSettings(db *gorm.DB) error {
    defaults := map[string]string{
        "general.system_name":     "STRMSync",
        "general.timezone":        "Asia/Shanghai",
        "general.log_level":       "info",
        "scan.concurrency":        "50",
        "scan.batch_size":         "1000",
        "scan.hash_sample_size":   "1048576",
        "scan.exclude_patterns":   ".tmp,.@__thumb,*.partial",
        "strm.path_format":        "absolute",
        "strm.encoding":           "utf-8",
        "strm.line_ending":        "lf",
        "scheduler.full_scan_cron": "0 2 * * *",
        "scheduler.cleanup_cron":  "0 3 * * 0",
    }

    for key, value := range defaults {
        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
        var count int64
        db.Model(&Setting{}).Where("key = ?", key).Count(&count)
        if count == 0 {
            db.Create(&Setting{
                Key:   key,
                Value: value,
            })
        }
    }

    return nil
}
```

---

## 7. æ€»ç»“

é€šè¿‡ Web ç•Œé¢ç®¡ç†é…ç½®çš„ä¼˜åŠ¿ï¼š

1. âœ… **ç”¨æˆ·å‹å¥½**ï¼šæ— éœ€æ‰‹åŠ¨ç¼–è¾‘ YAML æ–‡ä»¶
2. âœ… **å®æ—¶ç”Ÿæ•ˆ**ï¼šé…ç½®æ›´æ”¹ç«‹å³ç”Ÿæ•ˆ
3. âœ… **é…ç½®éªŒè¯**ï¼šå‰ç«¯è¡¨å•éªŒè¯ + åç«¯æ ¡éªŒ
4. âœ… **æµ‹è¯•åŠŸèƒ½**ï¼šé…ç½®å‰å¯ä»¥æµ‹è¯•è¿æ¥
5. âœ… **å®‰å…¨å­˜å‚¨**ï¼šå¯†ç å’Œ API Key åŠ å¯†å­˜å‚¨
6. âœ… **å†å²è®°å½•**ï¼šå¯ä»¥è®°å½•é…ç½®å˜æ›´å†å²ï¼ˆå¯é€‰ï¼‰
7. âœ… **å¤‡ä»½æ¢å¤**ï¼šå¯ä»¥å¯¼å‡º/å¯¼å…¥é…ç½®ï¼ˆå¯é€‰ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2024-02-16
**ä½œè€…**: STRMSync Team
